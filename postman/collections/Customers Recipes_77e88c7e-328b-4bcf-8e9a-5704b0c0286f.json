{
    "info": {
        "_postman_id": "27893926-4b4f-45f8-bd3f-ea92395e052d",
        "name": "Customers Recipes",
        "description": "This collection is designed to show how you might mock, test document a new API. In this case, we're assuming that we're going to create a basic user management API.\n\nIt has basic CRUD operations listed below.\n\nHit the \"Run in Postman\" button to see the pre-request and test scripts powering this collection.\n\nTry running the collection through the Collection Runner to see how the mock allows us to scope out all our responses and write our tests in advance.\n\n## Summary\n\nHaving undergone the effort of building out our collection in Postman first:\n\n- Using Postman Mocks\n- Writing tests\n \nThis has allowed us to then build out our API to match, meaning we could:\n(Update the `url` in the environment to `http://localhost:3000` and run the following Node API: https://github.com/matt-ball/users-api)\n\n- Debug our API as it was being built\n- Ensure parity with our mocks, meeting the designed blueprint\n- Run tests against the API as it was being built so that it's watertight\n\nAs a result:\n\n- We now have a shareable collection for our API\n- We have beautiful, rich documentation showing how it works\n- We can run our collection in a fully automated fashion and attach it to our CI/CD pipeline\n- We can create a Postman Monitor with no added effort to check for responsiveness and correctness",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "item": [
        {
            "name": "Merge customers",
            "item": [],
            "id": "3b1e23ac-0390-4f85-9625-6b97c09eadad"
        },
        {
            "name": "Bulk update customers",
            "item": [
                {
                    "name": "Get user by ID",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "const res = pm.response.json();",
                                    "const id = pm.globals.get('id');",
                                    "",
                                    "pm.test('Status code is 200', () => {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "pm.test('User matches requested user', () => {",
                                    "    const id = pm.request.url.query.get('id');",
                                    "    pm.expect(res[1].id).to.eql(id);",
                                    "});",
                                    "",
                                    "pm.test('User has correct type of user ID', () => {",
                                    "    pm.expect(res[1].id).to.be.a('string');",
                                    "});",
                                    "",
                                    "pm.test('Does not expose user password', () => {",
                                    "    pm.expect(res[1]).to.not.have.property('password');",
                                    "});",
                                    "",
                                    "pm.test('User has all relevant fields', () => {",
                                    "    pm.expect(res[1]).to.have.all.keys('id', 'firstName', 'lastName');",
                                    "});",
                                    "",
                                    "// cleanup",
                                    "pm.globals.unset('id');",
                                    "",
                                    "pm.sendRequest({",
                                    "    url: `${pm.environment.get('url')}/delete?id=${id}`,",
                                    "    method: 'delete'",
                                    "});"
                                ],
                                "type": "text/javascript",
                                "id": "dcc0c336-ec6d-4144-b82a-c93a989352f2"
                            },
                            "exec": [
                                "const res = pm.response.json();",
                                "const id = pm.globals.get('id');",
                                "",
                                "pm.test('Status code is 200', () => {",
                                "    pm.response.to.have.status(200);",
                                "});",
                                "",
                                "pm.test('User matches requested user', () => {",
                                "    const id = pm.request.url.query.get('id');",
                                "    pm.expect(res[1].id).to.eql(id);",
                                "});",
                                "",
                                "pm.test('User has correct type of user ID', () => {",
                                "    pm.expect(res[1].id).to.be.a('string');",
                                "});",
                                "",
                                "pm.test('Does not expose user password', () => {",
                                "    pm.expect(res[1]).to.not.have.property('password');",
                                "});",
                                "",
                                "pm.test('User has all relevant fields', () => {",
                                "    pm.expect(res[1]).to.have.all.keys('id', 'firstName', 'lastName');",
                                "});",
                                "",
                                "// cleanup",
                                "pm.globals.unset('id');",
                                "",
                                "pm.sendRequest({",
                                "    url: `${pm.environment.get('url')}/delete?id=${id}`,",
                                "    method: 'delete'",
                                "});"
                            ]
                        },
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "const firstName = pm.variables.get('firstName');",
                                    "const lastName = pm.variables.get('lastName');",
                                    "const password = pm.variables.get('password');",
                                    "",
                                    "pm.sendRequest({",
                                    "    url: `${pm.environment.get('url')}/create`,",
                                    "    method: 'POST',",
                                    "    header: 'Content-Type:application/x-www-form-urlencoded',",
                                    "    body: {",
                                    "        mode: 'raw',",
                                    "        raw: `firstName=${firstName}&lastName=${lastName}&password=${password}`",
                                    "    }",
                                    "}, (err, res) => {",
                                    "    res = res.json();",
                                    "    pm.globals.set('id', res.id);",
                                    "});"
                                ],
                                "type": "text/javascript",
                                "id": "27b4db1d-68a6-4796-a2f2-f5136f07ce22"
                            },
                            "exec": [
                                "const firstName = pm.variables.get('firstName');",
                                "const lastName = pm.variables.get('lastName');",
                                "const password = pm.variables.get('password');",
                                "",
                                "pm.sendRequest({",
                                "    url: `${pm.environment.get('url')}/create`,",
                                "    method: 'POST',",
                                "    header: 'Content-Type:application/x-www-form-urlencoded',",
                                "    body: {",
                                "        mode: 'raw',",
                                "        raw: `firstName=${firstName}&lastName=${lastName}&password=${password}`",
                                "    }",
                                "}, (err, res) => {",
                                "    res = res.json();",
                                "    pm.globals.set('id', res.id);",
                                "});"
                            ]
                        }
                    ],
                    "id": "ac92adb2-db88-4c05-9ac3-afc1d454adfa",
                    "protocolProfileBehavior": {
                        "disableBodyPruning": true
                    },
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "x-mock-response-name",
                                "value": "Get user by ID",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{url}}/get/?id={{id}}",
                            "host": [
                                "{{url}}"
                            ],
                            "path": [
                                "get",
                                ""
                            ],
                            "query": [
                                {
                                    "key": "id",
                                    "value": "{{id}}",
                                    "description": "The user's ID (required)"
                                }
                            ]
                        },
                        "description": "Retrieves a user by `id`."
                    },
                    "response": [
                        {
                            "id": "f221f870-9900-4316-a834-e568c2d83ec8",
                            "name": "Get user by ID",
                            "originalRequest": {
                                "method": "GET",
                                "header": [],
                                "url": {
                                    "raw": "{{url}}/get/?id={{id}}",
                                    "host": [
                                        "{{url}}"
                                    ],
                                    "path": [
                                        "get",
                                        ""
                                    ],
                                    "query": [
                                        {
                                            "key": "id",
                                            "value": "{{id}}",
                                            "description": "The user's ID (required)"
                                        }
                                    ]
                                }
                            },
                            "status": "OK",
                            "code": 200,
                            "_postman_previewlanguage": "json",
                            "header": [
                                {
                                    "key": "X-Powered-By",
                                    "value": "Express"
                                },
                                {
                                    "key": "Content-Type",
                                    "value": "application/json; charset=utf-8"
                                },
                                {
                                    "key": "Content-Length",
                                    "value": "105"
                                },
                                {
                                    "key": "ETag",
                                    "value": "W/\"69-PWyeF3E5khoqlHSeQl62TwtxWks\""
                                },
                                {
                                    "key": "Date",
                                    "value": "Fri, 11 Jan 2019 00:03:13 GMT"
                                },
                                {
                                    "key": "Connection",
                                    "value": "keep-alive"
                                }
                            ],
                            "cookie": [],
                            "responseTime": null,
                            "body": "[\n    {\n        \"status\": \"success\"\n    },\n    {\n        \"firstName\": \"Ben\",\n        \"lastName\": \"Smith\",\n        \"id\": \"0729d37c-ef9f-4ffa-8f71-a6eedf1f95b7\"\n    }\n]"
                        },
                        {
                            "id": "a038de81-f2e6-44b5-bc17-f99c480ce3e3",
                            "name": "Get user by ID (no user found)",
                            "originalRequest": {
                                "method": "GET",
                                "header": [],
                                "url": {
                                    "raw": "{{url}}/get/?id={{id}}",
                                    "host": [
                                        "{{url}}"
                                    ],
                                    "path": [
                                        "get",
                                        ""
                                    ],
                                    "query": [
                                        {
                                            "key": "id",
                                            "value": "{{id}}",
                                            "description": "The user's ID (required)"
                                        }
                                    ]
                                }
                            },
                            "status": "OK",
                            "code": 200,
                            "_postman_previewlanguage": "json",
                            "header": [
                                {
                                    "key": "X-Powered-By",
                                    "value": "Express"
                                },
                                {
                                    "key": "Content-Type",
                                    "value": "application/json; charset=utf-8"
                                },
                                {
                                    "key": "Content-Length",
                                    "value": "36"
                                },
                                {
                                    "key": "ETag",
                                    "value": "W/\"24-+nHORFhZtwqol4/kZqGURIjn3RE\""
                                },
                                {
                                    "key": "Date",
                                    "value": "Fri, 11 Jan 2019 00:39:07 GMT"
                                },
                                {
                                    "key": "Connection",
                                    "value": "keep-alive"
                                }
                            ],
                            "cookie": [],
                            "responseTime": null,
                            "body": "{\n    \"status\": \"no user found\",\n    \"id\": \"0729d37c-ef9f-4ffa-8f71-a6eedf1f95b\"\n}"
                        }
                    ]
                },
                {
                    "name": "Update user",
                    "id": "01a81987-9ae0-4695-9b99-39599064811c",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/form-urlencoded"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"firstName\": \"Benjamin\",\n    \"password\": \"foobar\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/update?id={{id}}",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "update"
                            ],
                            "query": [
                                {
                                    "key": "id",
                                    "value": "{{id}}",
                                    "description": "The user's ID (required)"
                                }
                            ]
                        },
                        "description": "Send the keys that you'd like to update, this can be one or more of `firstName`, `lastName` and `password`."
                    },
                    "response": [
                        {
                            "id": "d08f3e99-55eb-4464-9674-8dabf399b1e5",
                            "name": "Update user",
                            "originalRequest": {
                                "method": "PUT",
                                "header": [],
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n    \"firstName\": \"Benjamin\",\n    \"password\": \"foobar\"\n}"
                                },
                                "url": {
                                    "raw": "{{baseUrl}}/update?id={{id}}",
                                    "host": [
                                        "{{baseUrl}}"
                                    ],
                                    "path": [
                                        "update"
                                    ],
                                    "query": [
                                        {
                                            "key": "id",
                                            "value": "{{id}}"
                                        }
                                    ]
                                }
                            },
                            "status": "OK",
                            "code": 200,
                            "_postman_previewlanguage": "json",
                            "header": [
                                {
                                    "disabled": false,
                                    "key": "Connection",
                                    "value": "keep-alive",
                                    "description": ""
                                },
                                {
                                    "disabled": false,
                                    "key": "Content-Length",
                                    "value": "106",
                                    "description": ""
                                },
                                {
                                    "disabled": false,
                                    "key": "Date",
                                    "value": "Fri, 11 Jan 2019 00:18:07 GMT",
                                    "description": ""
                                },
                                {
                                    "disabled": false,
                                    "key": "ETag",
                                    "value": "W/\"6a-SA9mzR+M2pmN7WPGgLm1ZqtRYis\"",
                                    "description": ""
                                },
                                {
                                    "disabled": false,
                                    "key": "X-Powered-By",
                                    "value": "Express",
                                    "description": ""
                                },
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                }
                            ],
                            "cookie": [],
                            "responseTime": null,
                            "body": "{\n \"firstName\": \"Benjamin\",\n \"id\": \"0729d37c-ef9f-4ffa-8f71-a6eedf1f95b7\",\n \"lastName\": \"Smith\",\n \"status\": \"success\"\n}"
                        }
                    ]
                }
            ],
            "id": "c4fe6431-0253-47a6-881e-549710246fae"
        },
        {
            "name": "Join customers",
            "item": [
                {
                    "name": "New user",
                    "id": "9cb9c1d2-dcbe-429e-8e3b-12f1f55c20a7",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/form-urlencoded"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"firstName\": \"{{$randomFirstName}}\",\n    \"lastName\": \"{{$randomLastName}}\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/create",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "create"
                            ]
                        },
                        "description": "Creates a new user in the system. The user will be assigned an ID automatically. This can be found in the response."
                    },
                    "response": [
                        {
                            "id": "1e457eba-d414-4995-bcd5-dec3dccdec24",
                            "name": "New user",
                            "originalRequest": {
                                "method": "POST",
                                "header": [],
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n    \"firstName\": \"{{$randomFirstName}}\",\n    \"lastName\": \"{{$randomLastName}}\"\n}"
                                },
                                "url": {
                                    "raw": "{{baseUrl}}/create",
                                    "host": [
                                        "{{baseUrl}}"
                                    ],
                                    "path": [
                                        "create"
                                    ]
                                }
                            },
                            "status": "OK",
                            "code": 200,
                            "_postman_previewlanguage": "json",
                            "header": [
                                {
                                    "disabled": false,
                                    "key": "Connection",
                                    "value": "keep-alive",
                                    "description": ""
                                },
                                {
                                    "disabled": false,
                                    "key": "Content-Length",
                                    "value": "101",
                                    "description": ""
                                },
                                {
                                    "disabled": false,
                                    "key": "Date",
                                    "value": "Thu, 10 Jan 2019 23:58:59 GMT",
                                    "description": ""
                                },
                                {
                                    "disabled": false,
                                    "key": "ETag",
                                    "value": "W/\"65-KsPJ95rCxmmvvRBY2Sqroxk2vmA\"",
                                    "description": ""
                                },
                                {
                                    "disabled": false,
                                    "key": "X-Powered-By",
                                    "value": "Express",
                                    "description": ""
                                },
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                }
                            ],
                            "cookie": [],
                            "responseTime": null,
                            "body": "{\n \"firstName\": \"Ben\",\n \"id\": \"0729d37c-ef9f-4ffa-8f71-a6eedf1f95b7\",\n \"lastName\": \"Smith\",\n \"status\": \"success\"\n}"
                        }
                    ]
                }
            ],
            "id": "9389d580-7c17-42b1-bd72-9605900278e9"
        },
        {
            "name": "Retrieve by category",
            "item": [],
            "id": "34ea1b1b-7704-41a4-b519-20ddf3aabd6e"
        }
    ],
    "variable": [
        {
            "id": "b5460047-b199-48ea-8178-682cbcf498c1",
            "key": "baseUrl",
            "value": "{{url}}",
            "type": "string"
        }
    ]
}